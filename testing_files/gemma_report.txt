================================================================================
FIXED MEMORY TEST: KERAS GPT2 + OPENVINO
================================================================================
[STAGE] 0_INITIAL: 783.07 MB (swap: 0.00 MB) - Initial state after imports

>>> Loading GPT2 model from preset...
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[STAGE] 1_MODEL_LOADED: 10463.06 MB (swap: 0.00 MB) - gemma_2b_en model loaded (34.9s)
[STAGE] 2_BEFORE_INFERENCE: 10463.06 MB (swap: 0.00 MB) - Before first inference

>>> Running first inference (compilation + execution)...
    ‚è≥ Converting Keras -> OPENVINO and compiling...
[STAGE] 3_FIRST_INFERENCE: 6343.30 MB (swap: 16448.53 MB) - First inference completed via generate (160.3s)

>>> Second inference (no compilation)...
[STAGE] 4_SECOND_INFERENCE: 6028.95 MB (swap: 16766.20 MB) - Second inference (8.3s)
[STAGE] 5_FINAL: 6028.95 MB (swap: 16766.20 MB) - Final state

================================================================================
PERFORMANCE RESULTS
================================================================================
‚úÖ Generated text: 'Hello,

I have a problem with my'
‚úÖ Second generation: 'Test the series for convergence or divergence.

'
Backend: openvino
First inference latency: 160.29s
Second inference latency: 8.317s
Throughput: 0.04 tokens/sec
Speedup: 19.3x

üìä DETAILED MEMORY ANALYSIS:
+---------------------+------------+-------------+--------------+---------------+
| STAGE               |   RAM (MB) |   SWAP (MB) | RAM CHANGE   | SWAP CHANGE   |
+=====================+============+=============+==============+===============+
| Initial             |      783.1 |           0 | -            | -             |
+---------------------+------------+-------------+--------------+---------------+
| After model load    |    10463.1 |           0 | +9680.0      | +0.0          |
+---------------------+------------+-------------+--------------+---------------+
| Before inference    |    10463.1 |           0 | +0.0         | +0.0          |
+---------------------+------------+-------------+--------------+---------------+
| After 1st inference |     6343.3 |     16448.5 | -4119.8      | +16448.5      |
+---------------------+------------+-------------+--------------+---------------+
| After 2nd inference |       6029 |     16766.2 | -314.4       | +317.7        |
+---------------------+------------+-------------+--------------+---------------+
| Final               |       6029 |     16766.2 | +0.0         | +0.0          |
+---------------------+------------+-------------+--------------+---------------+
| Peak recorded       |    13431.4 |     16766.3 | +12648.3     | +16766.3      |
+---------------------+------------+-------------+--------------+---------------+

üîç MAIN MEMORY CONSUMERS:
   üìö Model loading:         +9680.0 MB RAM      +0.0 MB swap  (184.5% of total)
   ‚ö° Compilation/inference:  -4119.8 MB RAM  +16448.5 MB swap  (-78.5% of total)

üìà SUMMARY:
   üíæ Total RAM growth:      +5245.9 MB
   üíø Total swap change:    +16766.2 MB
   üìä Peak RAM consumption: +12648.3 MB above initial
   üî• Highest RAM recorded: 13431.4 MB
   üíø Peak swap consumption: +16766.3 MB above initial
   üî• Highest swap recorded: 16766.3 MB

üéØ MEMORY HEALTH CHECK:
   ‚ùå CRITICAL: RAM usage 12648 MB is very high (target <1GB)
   ‚ö†Ô∏è  WARNING: Peak swap usage 16766 MB indicates memory pressure
   üö® ALERT: Combined memory impact 30198 MB is very high

üéØ Test completed: {'success': True, 'model_loading_mb': 9679.9921875, 'compilation_mb': -4119.75390625, 'total_mb': 5245.88671875, 'peak_mb': 12648.28515625, 'peak_swap_mb': 16766.29296875}






================================================================================
FIXED MEMORY TEST: KERAS GPT2 + TENSORFLOW
================================================================================
2025-08-06 19:01:43.790291: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1754496103.890221   63071 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1754496103.918482   63071 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1754496104.175105   63071 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754496104.175164   63071 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754496104.175168   63071 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754496104.175173   63071 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
[STAGE] 0_INITIAL: 764.36 MB (swap: 0.00 MB) - Initial state after imports

>>> Loading GPT2 model from preset...
2025-08-06 19:01:49.285396: E external/local_xla/xla/stream_executor/cuda/cuda_platform.cc:51] failed call to cuInit: INTERNAL: CUDA error: Failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[STAGE] 1_MODEL_LOADED: 11980.12 MB (swap: 1406.66 MB) - gemma_2b_en model loaded (76.0s)
[STAGE] 2_BEFORE_INFERENCE: 11980.12 MB (swap: 1406.66 MB) - Before first inference

>>> Running first inference (compilation + execution)...
    ‚è≥ Converting Keras -> TENSORFLOW and compiling...
2025-08-06 19:03:06.613350: E tensorflow/core/util/util.cc:131] oneDNN supports DT_INT64 only on platforms with AVX-512. Falling back to the default Eigen-based implementation if present.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1754496201.787286   63224 service.cc:152] XLA service 0x70c29000fe60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
I0000 00:00:1754496201.788697   63224 service.cc:160]   StreamExecutor device (0): Host, Default Version
I0000 00:00:1754496202.797875   63224 device_compiler.h:188] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[STAGE] 3_FIRST_INFERENCE: 10755.66 MB (swap: 2473.30 MB) - First inference completed via generate (54.0s)

>>> Second inference (no compilation)...
[STAGE] 4_SECOND_INFERENCE: 10746.25 MB (swap: 2486.29 MB) - Second inference (5.7s)
[STAGE] 5_FINAL: 10746.41 MB (swap: 2486.29 MB) - Final state

================================================================================
PERFORMANCE RESULTS
================================================================================
‚úÖ Generated text: 'Hello,

I have a problem with my'
‚úÖ Second generation: 'Test the series for convergence or divergence.

'
Backend: tensorflow
First inference latency: 54.02s
Second inference latency: 5.725s
Throughput: 0.13 tokens/sec
Speedup: 9.4x

üìä DETAILED MEMORY ANALYSIS:
+---------------------+------------+-------------+--------------+---------------+
| STAGE               |   RAM (MB) |   SWAP (MB) | RAM CHANGE   | SWAP CHANGE   |
+=====================+============+=============+==============+===============+
| Initial             |      764.4 |           0 | -            | -             |
+---------------------+------------+-------------+--------------+---------------+
| After model load    |    11980.1 |      1406.7 | +11215.8     | +1406.7       |
+---------------------+------------+-------------+--------------+---------------+
| Before inference    |    11980.1 |      1406.7 | +0.0         | +0.0          |
+---------------------+------------+-------------+--------------+---------------+
| After 1st inference |    10755.7 |      2473.3 | -1224.5      | +1066.6       |
+---------------------+------------+-------------+--------------+---------------+
| After 2nd inference |    10746.2 |      2486.3 | -9.4         | +13.0         |
+---------------------+------------+-------------+--------------+---------------+
| Final               |    10746.4 |      2486.3 | +0.2         | -0.0          |
+---------------------+------------+-------------+--------------+---------------+
| Peak recorded       |      11996 |      5007.6 | +11231.6     | +5007.6       |
+---------------------+------------+-------------+--------------+---------------+

üîç MAIN MEMORY CONSUMERS:
   üìö Model loading:        +11215.8 MB RAM   +1406.7 MB swap  (112.4% of total)
   ‚ö° Compilation/inference:  -1224.5 MB RAM   +1066.6 MB swap  (-12.3% of total)

üìà SUMMARY:
   üíæ Total RAM growth:      +9982.1 MB
   üíø Total swap change:     +2486.3 MB
   üìä Peak RAM consumption: +11231.6 MB above initial
   üî• Highest RAM recorded: 11996.0 MB
   üíø Peak swap consumption:  +5007.6 MB above initial
   üî• Highest swap recorded: 5007.6 MB

üéØ MEMORY HEALTH CHECK:
   ‚ùå CRITICAL: RAM usage 11232 MB is very high (target <1GB)
   ‚ö†Ô∏è  WARNING: Peak swap usage 5008 MB indicates memory pressure
   üö® ALERT: Combined memory impact 17004 MB is very high

üéØ Test completed: {'success': True, 'model_loading_mb': 11215.765625, 'compilation_mb': -1224.46484375, 'total_mb': 9982.0546875, 'peak_mb': 11231.64453125, 'peak_swap_mb': 5007.61328125}









================================================================================
FIXED MEMORY TEST: KERAS GPT2 + JAX
================================================================================
2025-08-06 19:06:28.458983: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1754496388.518695   63518 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1754496388.537815   63518 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1754496388.656562   63518 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754496388.656621   63518 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754496388.656628   63518 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754496388.656633   63518 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
[STAGE] 0_INITIAL: 754.59 MB (swap: 0.00 MB) - Initial state after imports

>>> Loading GPT2 model from preset...
WARNING:2025-08-06 19:06:31,287:jax._src.xla_bridge:791: An NVIDIA GPU may be present on this machine, but a CUDA-enabled jaxlib is not installed. Falling back to cpu.
2025-08-06 19:07:18.398448: E external/local_xla/xla/stream_executor/cuda/cuda_platform.cc:51] failed call to cuInit: INTERNAL: CUDA error: Failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
[STAGE] 1_MODEL_LOADED: 10521.27 MB (swap: 41.75 MB) - gemma_2b_en model loaded (48.5s)
[STAGE] 2_BEFORE_INFERENCE: 10521.27 MB (swap: 41.75 MB) - Before first inference

>>> Running first inference (compilation + execution)...
    ‚è≥ Converting Keras -> JAX and compiling...
2025-08-06 19:07:21.865661: E tensorflow/core/util/util.cc:131] oneDNN supports DT_INT64 only on platforms with AVX-512. Falling back to the default Eigen-based implementation if present.
[STAGE] 3_FIRST_INFERENCE: 10735.61 MB (swap: 50.14 MB) - First inference completed via generate (19.6s)

>>> Second inference (no compilation)...
[STAGE] 4_SECOND_INFERENCE: 10738.36 MB (swap: 50.12 MB) - Second inference (5.1s)
[STAGE] 5_FINAL: 10738.36 MB (swap: 50.12 MB) - Final state

================================================================================
PERFORMANCE RESULTS
================================================================================
‚úÖ Generated text: 'Hello,

I have a problem with my'
‚úÖ Second generation: 'Test the series for convergence or divergence.

'
Backend: jax
First inference latency: 19.59s
Second inference latency: 5.150s
Throughput: 0.36 tokens/sec
Speedup: 3.8x

üìä DETAILED MEMORY ANALYSIS:
+---------------------+------------+-------------+--------------+---------------+
| STAGE               |   RAM (MB) |   SWAP (MB) | RAM CHANGE   | SWAP CHANGE   |
+=====================+============+=============+==============+===============+
| Initial             |      754.6 |           0 | -            | -             |
+---------------------+------------+-------------+--------------+---------------+
| After model load    |    10521.3 |        41.8 | +9766.7      | +41.8         |
+---------------------+------------+-------------+--------------+---------------+
| Before inference    |    10521.3 |        41.8 | +0.0         | +0.0          |
+---------------------+------------+-------------+--------------+---------------+
| After 1st inference |    10735.6 |        50.1 | +214.3       | +8.4          |
+---------------------+------------+-------------+--------------+---------------+
| After 2nd inference |    10738.4 |        50.1 | +2.8         | -0.0          |
+---------------------+------------+-------------+--------------+---------------+
| Final               |    10738.4 |        50.1 | +0.0         | +0.0          |
+---------------------+------------+-------------+--------------+---------------+
| Peak recorded       |    11282.8 |       196.7 | +10528.2     | +196.7        |
+---------------------+------------+-------------+--------------+---------------+

üîç MAIN MEMORY CONSUMERS:
   üìö Model loading:         +9766.7 MB RAM     +41.8 MB swap  (97.8% of total)
   ‚ö° Compilation/inference:   +214.3 MB RAM      +8.4 MB swap  (2.1% of total)

üìà SUMMARY:
   üíæ Total RAM growth:      +9983.8 MB
   üíø Total swap change:       +50.1 MB
   üìä Peak RAM consumption: +10528.2 MB above initial
   üî• Highest RAM recorded: 11282.8 MB
   üíø Peak swap consumption:   +196.7 MB above initial
   üî• Highest swap recorded: 196.7 MB

üéØ MEMORY HEALTH CHECK:
   ‚ùå CRITICAL: RAM usage 10528 MB is very high (target <1GB)
   ‚ÑπÔ∏è  INFO: Moderate peak swap usage 197 MB
   üö® ALERT: Combined memory impact 11480 MB is very high

üéØ Test completed: {'success': True, 'model_loading_mb': 9766.68359375, 'compilation_mb': 214.3359375, 'total_mb': 9983.77734375, 'peak_mb': 10528.20703125, 'peak_swap_mb': 196.73828125}